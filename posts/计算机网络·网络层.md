```markmap
# 网络层
## 功能概述 
- 数据报服务
    - 简单灵活 
    - 无连接
    - 尽最大努力交付
    - 为了使路由器简单
        可靠通信由传输层负责
        传送分组可能
        - 出错
        - 丢失
        - 重复
        - 失序
        - 超时
- 异构网络互连
    - 各层中继系统
        - 物理层
            - 转发器
            - 集线器
        - 数据链路层
            - 网桥
            - 交换机
        - 网络层
            - **路由器**
        - 网络层以上
            - 网关
- 路由与转发
    - 路由选择（确定哪一条路径）
        - 按照分布式算法
            根据从各相邻的路由器
            所得的关于整个网络拓扑的变化情况
            动态改变选择的路由
    - 分组转发（一个分组到达时采取的动作）
        - 根据转发表
            将用户IP数据报
            从合适端口转发出去
- SDN Software Define Network
    - 网络层定义
        - 数据平面
            - 转发
        - 控制平面
            - 路由选择
    - SDN网络
        - 数据、控制平面分离
        - 数据平面
            - 
        - 控制平面
            - 集中式
- 拥塞控制
    - 开环控制
    - 闭环控制

## 路由算法
- 静态路由算法
    - 非自适应路由算法
    - 网络管理员手动配置
    - 拓扑结构发生变化手动修改静态路由
    - 小型网络
- 动态路由算法
    - 自适应路由算法
    - 互连的路由器间彼此交换路由表
- 距离-向量算法
    - 所有节点定期
        将各自整个路由选择表
        转发到相邻节点
        - 每条路径的目的地
        - 路径的代价（距离）
        - RIP算法
- 链路状态路由算法
    - 每个参与算法的节点
        均具有完全的拓扑信息
        - 主动测试所有相邻节点
        - 定期将链路状态传播所有其他节点
    - OSPF算法
    - 洪泛法发送信息
    - 所有路由器
    - 路由器相邻的所有路由链路状态
    - 度量 metric
        - 费用
        - 距离
        - 时延
        - 带宽
    - 链路状态变化才发送
- 层次路由
    - 网络规模增大
        路由表增大
    - 整个互联网划分
        划分为很多较小的自治系统
    - 内部网关协议
        - RIP
        - OSPF
    - 外部网关协议
        - BGP
## IPV4
- IPV4分组
    - 首部长度
        - 占4位
        - 最大十进制数15
        - 最大值15 * 4B = 60B
    - 总长度
        - 首部和数据之和
        - 单位为字节
        - 以太网帧的最大传送单元
            MTU=1500B
        - 最大长度$2^{16}=65535B$
        - 标识 
            - 占16位
            - 计数器 i++
            - 数据报长度超过网络MTU
                必须分片
                此时每个数据报片
                均复制一次标识号
        - 标志
            - 占3位
            - 标志字段最低位MF
                MF=1表示后面还有分片
                MF=0表示最后一个分片
            - 标志字段中间的一位DF
                DF=0时才允许分片
        - 片偏移
            - 占13位
            - 较长的分组在分片后
                某片在原分组中相对位置
            - 以8个字节为偏移单位
            - 除最后一个分片
                每个分片的长度一定
                是8B的整数倍
        - 生存时间 TTL
            - 占8位
            - 数据报可通过路由数最大值
            - 确保分组不会永远在网络中循环
        - 协议
        - 首部校验和
        - 源地址字段
        - 目的地址字段
- 数据报分片
- NAT
- 子网划分
- 子网掩码
- CIDR
- ARP、DHCP、ICMP
## IPV6
## 路由协议
## IP组播
## 移动IP
## 网络层设备